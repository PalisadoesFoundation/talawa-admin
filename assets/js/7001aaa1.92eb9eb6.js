"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[40459],{23157:(e,n,r)=>{r.d(n,{A:()=>i});const i=r.p+"assets/files/eslint.config-af1d70727d3b8c8caa4105f7ea53eea7.js"},29438:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>a});var i=r(30758);const t={},s=i.createContext(t);function o(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:o(e.components),i.createElement(s.Provider,{value:n},e.children)}},89153:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"docs/developer-resources/security","title":"Security Guidelines","description":"Last updated: January 3, 2026","source":"@site/docs/docs/developer-resources/security.md","sourceDirName":"docs/developer-resources","slug":"/developer-resources/security","permalink":"/docs/developer-resources/security","draft":false,"unlisted":false,"editUrl":"https://github.com/PalisadoesFoundation/talawa-admin/edit/develop/docs/docs/docs/developer-resources/security.md","tags":[],"version":"current","sidebarPosition":12,"frontMatter":{"id":"security","title":"Security Guidelines","slug":"/developer-resources/security","sidebar_position":12},"sidebar":"tutorialSidebar","previous":{"title":"Introduction","permalink":"/docs/developer-resources/introduction"},"next":{"title":"Contributing","permalink":"/docs/developer-resources/contributing"}}');var t=r(86070),s=r(29438);const o={id:"security",title:"Security Guidelines",slug:"/developer-resources/security",sidebar_position:12},a="Security Guidelines",c={},l=[{value:"Token Handling and Authentication Security",id:"token-handling-and-authentication-security",level:2},{value:"1. Authorization Header Security",id:"1-authorization-header-security",level:3},{value:"2. Deprecated <code>REVOKE_REFRESH_TOKEN</code> Usage",id:"2-deprecated-revoke_refresh_token-usage",level:3},{value:"3. Avoiding <code>refreshToken</code> Variables",id:"3-avoiding-refreshtoken-variables",level:3},{value:"Migration Guide",id:"migration-guide",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"security-guidelines",children:"Security Guidelines"})}),"\n",(0,t.jsx)(n.p,{children:"Last updated: January 3, 2026"}),"\n",(0,t.jsx)(n.h2,{id:"token-handling-and-authentication-security",children:"Token Handling and Authentication Security"}),"\n",(0,t.jsx)(n.p,{children:"We have implemented strict ESLint rules to enforce secure token handling and prevent common vulnerabilities. These rules ensure that our authentication flow remains robust, using HTTP-only cookies and proper mutation practices."}),"\n",(0,t.jsx)(n.h3,{id:"1-authorization-header-security",children:"1. Authorization Header Security"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Rule:"})," ",(0,t.jsx)(n.code,{children:"Security Risk: Do not use getItem('token') directly inside authorization headers."})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"ESLint Error:"})," \"Security Risk: Do not use getItem('token') directly inside authorization headers. Extract it to a variable first to handle null values.\""]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose:"}),"\nPrevent potential ",(0,t.jsx)(n.code,{children:"null"})," or ",(0,t.jsx)(n.code,{children:"undefined"})," values being sent in the authorization header if ",(0,t.jsx)(n.code,{children:"localStorage"})," retrieval fails. It ensures defensive coding by requiring explicit variable assignment and checking."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Prohibited Pattern:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Unsafe: Direct usage inside object literal\nconst headers = {\n  authorization: localStorage.getItem('token'),\n};\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Safe Alternative:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Safe: Extract to variable first\nconst token = localStorage.getItem('token');\n\n// Option 1: With null check\nconst headers = {\n  authorization: token ? `Bearer ${token}` : '',\n};\n\n// Option 2: With fallback\nconst headers = {\n  authorization: `Bearer ${token || ''}`,\n};\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"2-deprecated-revoke_refresh_token-usage",children:["2. Deprecated ",(0,t.jsx)(n.code,{children:"REVOKE_REFRESH_TOKEN"})," Usage"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Rule:"})," ",(0,t.jsx)(n.code,{children:"HTTP-Only Cookie Violation: Do not use REVOKE_REFRESH_TOKEN for logout."})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"ESLint Error:"}),' "HTTP-Only Cookie Violation: Do not use REVOKE_REFRESH_TOKEN for logout. Use LOGOUT_MUTATION instead, which correctly reads refresh tokens from HTTP-only cookies."']}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose:"}),"\nThe ",(0,t.jsx)(n.code,{children:"REVOKE_REFRESH_TOKEN"})," mutation is deprecated for web clients because it relies on passing the refresh token from the client side. We have moved to an HTTP-only cookie-based authentication system where the server manages the tokens securely. The ",(0,t.jsx)(n.code,{children:"LOGOUT_MUTATION"})," is designed to work with this system."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Prohibited Pattern:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Deprecated\nimport { REVOKE_REFRESH_TOKEN } from 'GraphQl/Mutations/mutations';\n\nconst [revokeRefreshToken] = useMutation(REVOKE_REFRESH_TOKEN);\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Safe Alternative:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Recommended\nimport { LOGOUT_MUTATION } from 'GraphQl/Mutations/mutations';\n\nconst [logout] = useMutation(LOGOUT_MUTATION);\n"})}),"\n",(0,t.jsxs)(n.h3,{id:"3-avoiding-refreshtoken-variables",children:["3. Avoiding ",(0,t.jsx)(n.code,{children:"refreshToken"})," Variables"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Rule:"})," ",(0,t.jsx)(n.code,{children:"HTTP-Only Cookie Violation: Do not pass refreshToken as a variable."})]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"ESLint Error:"}),' "HTTP-Only Cookie Violation: Do not pass refreshToken as a variable. The API reads refresh tokens from HTTP-only cookies automatically."']}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Purpose:"}),"\nSince refresh tokens are now stored in HTTP-only cookies, the client code cannot and should not access them. Passing ",(0,t.jsx)(n.code,{children:"refreshToken"})," as a variable suggests incorrect handling where the client is manually managing the token, which bypasses the security benefits of HTTP-only cookies."]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Prohibited Pattern:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Incorrect: Manually passing refresh token\nlogout({ variables: { refreshToken: someToken } });\n"})}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"Safe Alternative:"})}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-javascript",children:"// Correct: Let the server read the HTTP-only cookie\nlogout();\n"})}),"\n",(0,t.jsx)(n.h2,{id:"migration-guide",children:"Migration Guide"}),"\n",(0,t.jsx)(n.p,{children:"If you encounter these linting errors in existing code:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Authorization Header:"})," Refactor the code to assign ",(0,t.jsx)(n.code,{children:"localStorage.getItem('token')"})," to a variable before using it in the header object."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Logout:"})," Replace ",(0,t.jsx)(n.code,{children:"revokeRefreshToken"})," mutation calls with ",(0,t.jsx)(n.code,{children:"logout"})," mutation calls. Ensure you handle the loading and error states appropriate for ",(0,t.jsx)(n.code,{children:"LOGOUT_MUTATION"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Variables:"})," Remove ",(0,t.jsx)(n.code,{children:"refreshToken"})," from the ",(0,t.jsx)(n.code,{children:"variables"})," object in your GraphQL mutation calls."]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["For any questions, please reach out to the maintainers or consult the ",(0,t.jsx)(n.a,{target:"_blank","data-noBrokenLinkCheck":!0,href:r(23157).A+"",children:"ESLint configuration"}),"."]})]})}function h(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}}}]);