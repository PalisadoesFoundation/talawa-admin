id: mutation-null-guard-check
language: typescript
rule:
  any:
    - pattern: |
        await $MUTATION({
          variables: {
            $$$
            id: $VAR?.$PROP
            $$$
          }
        })
    - pattern: |
        await $MUTATION({
          variables: {
            $$$
            $KEY: $VAR?.$PROP
            $$$
          }
        })
  not:
    follows:
      pattern: |
        if (!$VAR?.$PROP) return;
message: 'Missing null guard for optional property in mutation variables'
severity: error
